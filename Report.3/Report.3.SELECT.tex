\documentclass[12pt, letterpaper, twoside]{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{color}
\graphicspath{ {images/} }
 
\title{Lab work report 3 - SELECT}
\author{Cao Anh Quan - ICT Master}
\date{November 6, 2016}
 
 
\begin{document}
 
\begin{titlepage}
\maketitle
\end{titlepage}

\begin{enumerate}

\item All info of all employees
\begin{lstlisting}[language=SQL]
select * from employees;

| 499984 | 1959-08-31 | Kaijung        | Rodham           | M      | 1985-09-11 |
| 499985 | 1964-12-26 | Gila           | Lukaszewicz      | M      | 1997-02-11 |
| 499986 | 1952-07-22 | Nathan         | Ranta            | F      | 1985-08-11 |
| 499987 | 1961-09-05 | Rimli          | Dusink           | F      | 1998-09-20 |
| 499988 | 1962-09-28 | Bangqing       | Kleiser          | F      | 1986-06-06 |
| 499989 | 1954-05-26 | Keiichiro      | Lindqvist        | M      | 1993-10-28 |
| 499990 | 1963-11-03 | Khaled         | Kohling          | M      | 1985-10-10 |
| 499991 | 1962-02-26 | Pohua          | Sichman          | F      | 1989-01-12 |
| 499992 | 1960-10-12 | Siamak         | Salverda         | F      | 1987-05-10 |
| 499993 | 1963-06-04 | DeForest       | Mullainathan     | M      | 1997-04-07 |
| 499994 | 1952-02-26 | Navin          | Argence          | F      | 1990-04-24 |
| 499995 | 1958-09-24 | Dekang         | Lichtner         | F      | 1993-01-12 |
| 499996 | 1953-03-07 | Zito           | Baaz             | M      | 1990-09-27 |
| 499997 | 1961-08-03 | Berhard        | Lenart           | M      | 1986-04-21 |
| 499998 | 1956-09-05 | Patricia       | Breugel          | M      | 1993-10-13 |
| 499999 | 1958-05-01 | Sachin         | Tsukuda          | M      | 1997-11-30 |
+--------+------------+----------------+------------------+--------+------------+
300024 rows in set (0.21 sec)


\end{lstlisting}

\item All info of all departments
\begin{lstlisting}[language=SQL]

select * from departments;

+---------+--------------------+
| dept_no | dept_name          |
+---------+--------------------+
| d009    | Customer Service   |
| d005    | Development        |
| d002    | Finance            |
| d003    | Human Resources    |
| d001    | Marketing          |
| d004    | Production         |
| d006    | Quality Management |
| d008    | Research           |
| d007    | Sales              |
+---------+--------------------+
9 rows in set (0.00 sec)

\end{lstlisting}

\item Full names of all employees
\begin{lstlisting}[language=SQL]

select CONCAT(first_name ," ",last_name) as full_name 
from employees

| Gino Usery                     |
| Yunming Mitina                 |
| Mohammed Pleszkun              |
| Uri Juneja                     |
| Kaijung Rodham                 |
| Gila Lukaszewicz               |
| Nathan Ranta                   |
| Rimli Dusink                   |
| Bangqing Kleiser               |
| Keiichiro Lindqvist            |
| Khaled Kohling                 |
| Pohua Sichman                  |
| Siamak Salverda                |
| DeForest Mullainathan          |
| Navin Argence                  |
| Dekang Lichtner                |
| Zito Baaz                      |
| Berhard Lenart                 |
| Patricia Breugel               |
| Sachin Tsukuda                 |
+--------------------------------+
300024 rows in set (0.12 sec)

\end{lstlisting}

\item Names of all departments
\begin{lstlisting}[language=SQL]

select dept_name from departments;

+--------------------+
| dept_name          |
+--------------------+
| Customer Service   |
| Development        |
| Finance            |
| Human Resources    |
| Marketing          |
| Production         |
| Quality Management |
| Research           |
| Sales              |
+--------------------+
9 rows in set (0.00 sec)


\end{lstlisting}

\item Full names of employees working in "Sales" department
\begin{lstlisting}[language=SQL]

select CONCAT(first_name," ",last_name) as full_name 
from employees where emp_no 
in
(select emp_no from dept_emp where dept_no 
in (select dept_no from departments 
where dept_name = "Sales"))


| Paris Deyuan                  |
| Lihong Pusterhofer            |
| Akeel Baez                    |
| Changho Noriega               |
| Rosalie Slobodova             |
| Doohun Schnelling             |
| Susanne Matteis               |
| Marco Cairo                   |
| Morris Smeets                 |
| Fumiko Luke                   |
| Chenyi Hainaut                |
| Jagoda Lanphier               |
| Maja Lamba                    |
| Raimond Leuchs                |
| Mong Usdin                    |
| Make Terekhov                 |
| Aloke Wuwongse                |
| Masako Angiulli               |
| Christ Murtagh                |
| Youpyo Perfilyeva             |
| Leszek Pulkowski              |
| Gaetan Veldwijk               |
| Mihalis Crabtree              |
| Bangqing Bodoff               |
| Guozhong Felder               |
| Gino Usery                    |
| Nathan Ranta                  |
| Rimli Dusink                  |
| Bangqing Kleiser              |
+-------------------------------+
52245 rows in set (0.27 sec)


\end{lstlisting}

\item Full names of male employees working in "Finance" department
\begin{lstlisting}[language=SQL]

select CONCAT(first_name," ",last_name) as full_name 
from employees where
emp_no in
(select emp_no from dept_emp where dept_no 
in (select dept_no from departments 
where dept_name = "Finance")) 
and gender = "M";


| Peer Gist                    |
| Sachio Cannane               |
| Huican Gelosh                |
| Masamitsu Matheson           |
| Doohun Pelz                  |
| Parto Kambil                 |
| Haldun Mullainathan          |
| Ymte Potthoff                |
| Nagui Stamatiou              |
| Bernd Gluchowski             |
| Phillip Panienski            |
| Sastry Szmurlo               |
| Jacopo Hasham                |
| Moon Pleszkun                |
| Hercules Porotnikoff         |
| Shaz Bierbaum                |
| Masali Chorvat               |
| Keiichiro Lindqvist          |
| Patricia Breugel             |
+------------------------------+
10331 rows in set (0.07 sec)


\end{lstlisting}

\item Salaries of female employees working in "Marketing" department
\begin{lstlisting}[language=SQL]

select salary from salaries
where emp_no in 
(select emp_no from employees 
where gender = "F" and
emp_no in
(select emp_no from dept_emp where dept_no 
in (select dept_no from departments
 where dept_name = "Marketing")));
 
 |  73008 |
|  75462 |
|  76837 |
|  43005 |
|  47320 |
|  50713 |
|  52539 |
|  56516 |
|  59357 |
|  63601 |
|  64778 |
|  65475 |
|  69488 |
|  72212 |
|  71874 |
|  73574 |
|  76708 |
|  79327 |
|  80389 |
+--------+
74996 rows in set (0.26 sec)


\end{lstlisting}

\item Full names of employees who have the same last name as their manager
\begin{lstlisting}[language=SQL]

select concat(first_name," ",last_name) as full_name
from employees 
where last_name in 
(select last_name from employees
where emp_no in 
(select emp_no from dept_manager));

| Geoffry Alpin              |
| Chinho Hagimont            |
| Zorica Ghazalie            |
| Adas Hofmeyr               |
| Heping Alpin               |
| Shigeaki DasSarma          |
| Yinghua Markovitch         |
| Mingzeng Quadeer           |
| Sanjay Sigstam             |
| Abdelkader Ghazalie        |
| Gudjon Hagimont            |
| Padma Hofmeyr              |
| Suvo Minakawa              |
| Xiaoshan Sigstam           |
| Mong Staelin               |
| Parto Kambil               |
| Martine Markovitch         |
| Zine Ghazalie              |
| Vasilis Kaelbling          |
| Xiadong Hofmeyr            |
| Hidde Alpin                |
| Heekeun Weedman            |
+----------------------------+
4403 rows in set (0.57 sec)

\end{lstlisting}

\item Full names of managers who have been doing the job twice
\begin{lstlisting}[language=SQL]

select count(1)/2 as managers_number from
dept_manager x join dept_manager y on
x.emp_no = y.emp_no
and x.dept_no <> y.dept_no;

+-----------------+
| managers_number |
+-----------------+
|          1.0000 |
+-----------------+
1 row in set (0.00 sec)


\end{lstlisting}

\item Full names of employees who was paid more than \$100000
\begin{lstlisting}[language=SQL]

select concat(first_name," ",last_name) as full_name
from employees 
where emp_no in 
(select emp_no from salaries
where salary > 100000)

| Aamod Bernatsky             |
| Maya Melter                 |
| Uriel Daescu                |
| Zengping Peir               |
| Akhilish Zobel              |
| Feipei Setlzner             |
| Saniya Hettesheimer         |
| Foong Godskesen             |
| Lihong Pusterhofer          |
| Akeel Baez                  |
| Armond Fraisse              |
| Christoph Schneeberger      |
| Mong Usdin                  |
| Aloke Wuwongse              |
| Masako Angiulli             |
| Christ Murtagh              |
| Youpyo Perfilyeva           |
| Leszek Pulkowski            |
| Danai Hedayat               |
| Guozhong Felder             |
| Gino Usery                  |
| Nathan Ranta                |
| Bangqing Kleiser            |
+-----------------------------+
19018 rows in set (1.27 sec)



\end{lstlisting}

\item Names of all departments that have employees paid morethan \$1000000
\begin{lstlisting}[language=SQL]

select dept_name 
from  departments
where dept_no in
(select dept_no 
from dept_emp 
where emp_no in
(select emp_no 
from salaries
where salary > 100000 ));

+--------------------+
| dept_name          |
+--------------------+
| Customer Service   |
| Development        |
| Finance            |
| Human Resources    |
| Marketing          |
| Production         |
| Quality Management |
| Research           |
| Sales              |
+--------------------+
9 rows in set (0.00 sec)


\end{lstlisting}

\end{enumerate}




 
\end{document}
